@page "/shopping-lists"
@inherits IndexBase

<DynamicPageTitle Title="Shopping Lists" />

<MudBreadcrumbs Items="Breadcrumbs"></MudBreadcrumbs>


<MudText Typo="Typo.h4" Class="mb-6">Shopping Lists</MudText>

<SearchForm T="SearchShoppingListsModel" @bind-Model="@SearchModel" Class="mb-6" SearchClicked="@(() => DoSearch(1))"
ResetClicked="@HandleResetClicked" Disable="@IsLoading" VerticalButtons="Breakpoint.Sm">
	<SearchFields>
		<MudGrid Spacing="1">
			<MudItem xs="12">
				<MudTextField Label="Title" Variant="Variant.Outlined" FullWidth="true" Margin="Margin.Dense"
				T="string" @bind-Value="@SearchModel.Title" Disabled="@IsLoading" />
			</MudItem>
		</MudGrid>
	</SearchFields>
</SearchForm>

@if (ActiveMember.HasHouseholdPermissionLevel(PermissionLevels.Write))
{
	<MudToolBar Class="mt-6" Gutters="false" Dense="true">
		<MudButton StartIcon="@Icons.Material.Filled.AddCircleOutline" Disabled="@IsLoading" OnClick="@HandleAddClicked">Add</MudButton>
	</MudToolBar>
}

<ListView TItem="ShoppingListModel" Items="@SearchResults.Data" IsLoading="@IsLoading" TotalItems="@SearchResults.Total" Page="@SearchModel.Page"
			PageSize="SearchModel.PageSize" PageSelected="@HandlePageSelected">
	<ItemRenderer>
		<MudLink Typo="Typo.subtitle1" Class="d-block" Color="Color.Primary" Href="@($"/shopping-lists/{context.Item.Sid}")">@context.Item.Title</MudLink>
		@if (!string.IsNullOrEmpty(context.Item.StoreSid))
		{
			<MudText Typo="Typo.body2" Color="Color.Tertiary">@context.Item.StoreName</MudText>
		}
	</ItemRenderer>
	<EmptyListRenderer>
		<MudAlert Elevation="0" ContentAlignment="HorizontalAlignment.Center" NoIcon="true" Class="mt-4">No shopping lists matched your search.</MudAlert>
	</EmptyListRenderer>
</ListView>

<SideDrawer Title="Add Shopping List" Icon="@Icons.Material.Filled.AddCircle" @bind-Open="DrawerOpen">
	<FormProperties Model="@FormModel" FormId="@FormId" DisableFormControls="@IsSaving" OnFormSubmitted="@HandleFormAddSubmit">
		<FormToolbar>
			<MudSpacer />
			<ProgressButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Secondary" IsWorking="@IsWorking" WorkingText="Adding">Create</ProgressButton>
			<MudButton Variant="Variant.Outlined" Color="Color.Secondary" OnClick="@HandleCancelClicked">Cancel</MudButton>
			<MudSpacer />
		</FormToolbar>
	</FormProperties>
</SideDrawer>