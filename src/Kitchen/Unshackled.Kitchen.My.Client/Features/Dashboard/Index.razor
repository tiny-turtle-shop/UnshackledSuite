@page "/"
@inherits IndexBase

<DynamicPageTitle Title="Dashboard" />

<MudGrid Spacing="6" Justify="Justify.SpaceAround">
	<MudItem xs="12" sm="8" md="12">
		<div class="d-flex align-center gap-2 flex-row flex-wrap justify-center">
			<DashboardTile Typo="Typo.body2" Href="/cookbooks" Icon="@Icons.Material.Filled.CollectionsBookmark" Title="Cookbooks" />
			<DashboardTile Typo="Typo.body2" Href="/households" Icon="@Icons.Material.Filled.Groups" Title="Households" />
			<DashboardTile Typo="Typo.body2" Href="/meal-plan" Icon="@Icons.Material.Filled.CalendarMonth" Title="Meal Plan" />
			<DashboardTile Typo="Typo.body2" Href="/recipes" Icon="@Icons.Material.Filled.Dining" Title="Recipes" />
			<DashboardTile Typo="Typo.body2" Href="/shopping-lists" Icon="@Icons.Material.Filled.ShoppingBag" Title="Shopping Lists" />
			<DashboardTile Typo="Typo.body2" Href="/products" Icon="@Icons.Material.Filled.ShoppingBasket" Title="Products" />
		</div>
	</MudItem>
	@if (PinnedCategories.Count > 0)
	{
		@if (string.IsNullOrEmpty(SelectedCategorySid))
		{
			<MudItem xs="12" sm="8" md="12">
				<MudText Typo="Typo.body2" Color="Color.Tertiary" Align="Align.Center" Class="mb-3">Pinned Categories</MudText>
				<div class="d-flex align-center gap-2 flex-row flex-wrap justify-center">
					@foreach (var item in PinnedCategories)
					{
						<DashboardTile Typo="Typo.body1" OnClick="@(() => HandleCategoryClicked(item.Sid))" Title="@item.Title" />
					}
				</div>
			</MudItem>
		}
		else 
		{
			<MudItem xs="12" sm="8" md="6">
				<MudText Typo="Typo.body2" Color="Color.Tertiary">Pinned Products</MudText>
				@if (PinnedCategories.Count > 1)
				{
					<MudToolBar Gutters="false" Class="mt-2">
						<MudButton OnClick="@(() => HandleCategoryClearClicked())" StartIcon="@Icons.Material.Filled.ArrowBack">Back</MudButton>
					</MudToolBar>
				}
				<ListView Items="@FilteredProducts">
					<ItemRenderer>
						<MudLink Typo="Typo.subtitle1" OnClick="@(() => HandleAddToListClicked(context.Item.Sid))" Underline="Underline.None">
							<div class="d-flex flex-row gap-2 align-center">
								<MultipleImageComponent BaseUrl="@StorageSettings.BaseUrl" Class="image-thumbnail-50" Images="@context.Item.Images" GalleryTitle="Product Image" AspectRatio="AspectRatios.R1x1" />
								<div>
									@if (!string.IsNullOrEmpty(context.Item.Brand))
									{
										<MudText Typo="Typo.body2" Color="Color.Tertiary">@context.Item.Brand</MudText>
									}
									<MudText Typo="Typo.body1" Color="Color.Primary">@context.Item.Title</MudText>
									@if (!string.IsNullOrEmpty(context.Item.Description))
									{
										<MudText Typo="Typo.caption" Color="Color.Tertiary">@context.Item.Description</MudText>
									}
								</div>
							</div>
						</MudLink>
					</ItemRenderer>
				</ListView>
			</MudItem>
		}
	}
</MudGrid>

<SideDrawer Title="@DrawerTitle" Open="@DrawerOpen" OpenChanged="@(() => HandleCancelClicked())">
	@if (DrawerView == Views.AddToList)
	{
		<DrawerAddToList ShoppingLists="@ShoppingLists" OnCanceled="@HandleCancelClicked" OnAdded="@HandleAddToListSubmitted" />
	}
</SideDrawer>